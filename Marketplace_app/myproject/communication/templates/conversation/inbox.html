{% extends 'base.html' %}

{% block content %}
<h1 class="mb-6 text-3xl font-bold">Inbox</h1>

<div class="space-y-6">
    {% for conversation in conversations %}
        <a href="{% url 'conversation:detail' conversation.id %}">
            <div class="flex items-center p-6 bg-gray-100 rounded-xl hover:bg-gray-200 transition">

                <!-- Item Image -->
                <div class="mr-6">
                    {% if conversation.item.image %}
                        <img src="{{ conversation.item.image.url }}" alt="{{ conversation.item.name }}" class="w-20 h-20 object-cover rounded-xl">
                    {% else %}
                        <div class="w-20 h-20 bg-gray-300 rounded-xl flex items-center justify-center text-gray-600">No Image</div>
                    {% endif %}
                </div>

                <!-- Conversation Info -->
                <div class="flex-1">
                    <!-- Product/Item Name -->
                    <h2 class="text-xl font-semibold mb-1">{{ conversation.item.name }}</h2>
                    
                    <!-- Last Updated -->
                    <p class="text-gray-500 text-sm mb-2">Last updated: {{ conversation.modified_at|date:"M d, Y H:i" }}</p>
                    
                    <!-- Participants (excluding current user) -->
<p class="text-gray-700">
    Participants (excluding you):
    {% for member in conversation.members.all %}
        {% if member != request.user %}
            {{ member.username }}{% if not forloop.last %}, {% endif %}
        {% endif %}
    {% empty %}
        No other participants
    {% endfor %}
</p>

<p class="text-gray-700">
    All members:
    {% for member in conversation.members.all %}
        {{ member.username }}{% if not forloop.last %}, {% endif %}
    {% endfor %}
</p>


                </div>
            </div>
        </a>
    {% empty %}
        <p class="text-gray-500">You have no conversations yet.</p>
    {% endfor %}
</div>
{% endblock %}
